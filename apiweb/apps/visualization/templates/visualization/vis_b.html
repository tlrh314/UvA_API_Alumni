{% extends "base.html" %}
{% load static %}

{% block stylesheets %} {{ block.super }} 
<style>
    .modebar {
        display: none !important;
    }
    #chartContainer {
        height: 600px;
        width: 100%;
    }
</style>{% endblock stylesheets %}

{% block title %} API - Visualisation - Tree {% endblock title %}

{% block content %}

<div class="main-content" role="main">
    <h1 class="text-center"> Student-Supervisor Relation Tree </h1>
        <div id="tree-wrapper">
        <div id="chartContainer"></div>
    </div>
</div>

<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<script type="text/javascript">
    var data = '{{ json_data | safe }}',
        graph = JSON.parse(data);

    console.log(graph);

    var ctx = $('#chart');

    makeGraph(graph.jobs_cur);

    function makeGraph(dataset) {
        var plotData = []
        var labelsData = []
        $.each(dataset, function(key, val) {
            plotData.push(+val);
            labelsData.push(key);
        });
        console.log(plotData, labelsData);

        Plotly.newPlot('chartContainer', [{
            values: plotData,   
            labels: labelsData,
            type: 'pie',
            hoverinfo: 'label+percent'
        }]);
        //     // These labels appear in the legend and in the tooltips when hovering different arcs
        //     options: Chart.defaults.pie
        // });
    }

</script>

{% endblock content %}