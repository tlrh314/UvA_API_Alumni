{% extends "base.html" %}
{% load bootstrap3 %}
{% load template_filters %}

{% block stylesheets %} {{ block.super }} {% endblock stylesheets %}

{% block title %}API - Research - Theses{% endblock title %}

{% block content %}

<div class="main-content" role="main">
    {% bootstrap_messages %}

    <h2 class="text-center">Total number of alumni: {{ alumni.paginator.count }}</h2>
    {# Filters #}
    {# TODO: margin auto 0 to center #}
    <div class="col-md-12 text-center">
        <ul class="nav nav-pills selector-nav center-pills">  
            {# Gender dropdown menu #}
            <li role="presentation" class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                   aria-expanded="false">Gender<span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="{% filter_objects 'gender' 'None' %}"><i> No filter </i></a></li>
                    {% get_genders as genders %}
                    {% for choice in genders %}
                    {# Reset possible old filter and add store filter #}
                    <li>
                        <a href="{% filter_objects 'gender' choice.0 %}" class="menu-link"> 
                            <div class="menu-text"> {{ choice.1 }} </div>
                            <img class="check-box" src="{% check_dropdown 'gender' choice.0 %}">
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </li>

            {# Defence year dropdown menu #}
            {% get_defence_years as years %}
            <li role="presentation" class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                   aria-expanded="false">Year<span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="{% filter_objects 'year' 'None' %}"><i> No filter </i></a></li>
                    {% for year in years %}
                    {# Reset possible old filter and add store filter #}
                    <li>
                        <a href="{% filter_objects 'year' year.1 %}" class="menu-link"> 
                            <div class="menu-text"> {{ year.0 }} </div>
                            <img class="check-box" src="{% check_dropdown 'year' year.1 %}">
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </li>

            {# Degree type dropdown menu #}
            {% get_degree_types as degrees %}
            <li role="presentation" class="dropdown">
                <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
                   aria-expanded="false">Type<span class="caret"></span>
                </a>
                <ul class="dropdown-menu">
                    <li><a href="{% filter_objects 'type' 'None' %}"><i> No filter </i></a></li>
                    {% for type in degrees %}
                    {# Reset possible old filter and add store filter #}
                    <li>
                        <a href="{% filter_objects 'type' type.0 %}" class="menu-link"> 
                            <div class="menu-text"> {{ type.1 }} </div>
                            <img class="check-box" src="{% check_dropdown 'type' type.0 %}">
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </li>

            {# Reset all filters #}
            <li role="presentation" class="dropdown">
            <a class="dropdown-toggle" href="{% url 'alumni:alumnus-list' %}" aria-haspopup="true"
                   aria-expanded="false"> Reset All Filters
                </a>
                    
            </li>
        </ul>
    </div>
    {# End Filters #}

    <table class="table table-hover">
        <thead>
            <tr>
                <th>Alumnus</th>
                <th> MSc </th>
                <th> PhD  </th>
            </tr>
        </thead>
        <tbody>
            {# Page limit selector #}
            <div class="pages-parent" style="display: inline; float: left;">
             <li class="dropdown no-bullets" style="display: inline;">
              <a type="button" class="dropdown-toggle" data-toggle="dropdown" href="#">
                {{ alumni_per_page }}  <span class="caret"></span>
              </a>
              <ul class="nr-pages dropdown-menu no-bullets " style='min-width: 30px;' role="menu">
                <li><a {% if alumni_per_page == 15 %} class='active' {% endif %} href="{% set_query 'limit' 15 %}">15 </a></li>
                <li><a {% if alumni_per_page == 30 %} class='active' {% endif %} href="{% set_query 'limit' 30 %}">30 </a></li>
                <li><a {% if alumni_per_page == 45 %} class='active' {% endif %} href="{% set_query 'limit' 45 %}">45</a></li>
                <li><a {% if alumni_per_page == 60 %} class='active' {% endif %} href="{% set_query 'limit' 60 %}">60</a></li>
                <!--<li class="divider" style="min-width: 30px; padding: 0px; margin: : 0px;"></li>-->
                <li><a {% if alumni_per_page == 100 %} class='active' {% endif %} href="{% set_query 'limit' 100 %}">100</a></li>
                <li><a {% if alumni_per_page == 200 %} class='active' {% endif %} href="{% set_query 'limit' 200 %}">200</a></li>
                </ul>
                </li> alumni per page 
            </div>

            {# Add the paginator #}
            <div class="pagination-custom pull-right">
                <nav class="content-pagination">
                    <a href="#" class='older fontawesome-angle-left' title='Older'></a>
                    
                    {% if alumni.has_previous %}
                        <a href="{% filter_content 'page' 1 %}"><i class="fa fa-angle-double-left fa-lg" aria-hidden="true"></i></a>
                        <a href="{% filter_content 'page' alumni.previous_page_number %}"><i class="fa fa-angle-left fa-lg" style="max-width: 6px;"></i></a>
                    {% endif %}
                
                    <span class="pagination-text">
                        Page {{ alumni.number }} of {{ alumni.paginator.num_pages }}
                    </span>
                
                    {% if alumni.has_next %}
                        <a href="{% filter_content 'page' alumni.next_page_number %}"><i class="fa fa-angle-right fa-lg"></i></a>
                        <a href="{% filter_content 'page' alumni.paginator.num_pages %}"><i class="fa fa-angle-double-right fa-lg" aria-hidden="true"></i></a>
                    {% endif %}
                </nav>
            </div>



            {# Add the content #}
            {% for alumnus in alumni %}
            <tr class="{% cycle '' 'info' %}">
                <td><a href="{% url 'alumni:alumnus-detail' alumnus.slug %}">{{ alumnus.full_name }}</a></td>
                    <td> 
                    {% for degree in alumnus.degrees.all %}
                        {% if degree.type == 'msc'%}
                            {{ degree.date_stop|date:"Y" }} 
                        {% endif %}
                    {% endfor %}
                    </td>
                    <td>
                    {% for degree in alumnus.degrees.all %}
                        {% if degree.type == 'phd'%}
                            {{ degree.date_of_defence|date:"Y" }} 
                        {% endif %}
                    {% endfor %}
                    </td>
                    <td> </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>


{% endblock content %}
